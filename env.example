# ==========================================
# OpenSAM 통합 환경 변수 설정 (.env)
# ==========================================
# 모든 서버 및 게임 설정이 이 파일 하나로 관리됩니다.
# 사용법: 이 파일을 .env로 복사 후 값을 수정하세요.
# ==========================================

# [System] 기본 인프라 설정
# 실행 환경 (development, production, test)
NODE_ENV=development
# API 서버 포트 번호
PORT=8080
# 서버 타임존 설정 (한국: Asia/Seoul)
TZ=Asia/Seoul
# 프론트엔드 접속 주소 (CORS 및 리다이렉션 용)
FRONTEND_URL=http://localhost:3000
# 프론트엔드에서 참조할 백엔드 API 주소
NEXT_PUBLIC_API_URL=http://localhost:8080

# [Database] MongoDB 설정
# Docker 내부 네트워크용: mongodb://admin:changeme_secure_password@mongodb:27017/sangokushi?authSource=admin
# 로컬 실행용: mongodb://admin:changeme_secure_password@localhost:27017/sangokushi?authSource=admin
MONGODB_URI=mongodb://admin:changeme_secure_password@mongodb:27017/sangokushi?authSource=admin

# [Cache] Redis 설정
# Docker 내부 네트워크용: redis://:changeme_redis_password@redis:6379/0
# 로컬 실행용: redis://:changeme_redis_password@localhost:6379/0
REDIS_URL=redis://:changeme_redis_password@redis:6379/0
REDIS_KEY_PREFIX=opensam:
ENABLE_REDIS_ADAPTER=true

# [Security] 보안 및 인증
JWT_SECRET=your_jwt_secret_key_here_please_change_this
JWT_REFRESH_SECRET=your_jwt_refresh_secret_key_here_please_change_this
CORS_ORIGIN=http://localhost:3000
BACKEND_URL=http://backend:8080
DISABLE_CSRF=false
COOKIE_SECURE=false
COOKIE_SAMESITE=lax
# 서버 고유 시드 (난수 생성용)
SERVER_HIDDEN_SEED=opensam_hidden_seed
# 현재 시즌 번호
SERVER_SEASON_INDEX=0

# [Rate Limit] 트래픽 제어 (ms / max_requests)
# 전체 요청 제어 주기 및 최대 횟수
RATE_LIMIT_GLOBAL_WINDOW_MS=900000
RATE_LIMIT_GLOBAL_MAX=1000
# 로그인/회원가입 시도 제어
RATE_LIMIT_AUTH_WINDOW_MS=900000
RATE_LIMIT_AUTH_MAX=10
# 일반 API 요청 제어
RATE_LIMIT_API_WINDOW_MS=900000
RATE_LIMIT_API_MAX=100

# [Game Session] 게임 서버 식별
# 기본 게임 세션 ID
SESSION_ID=sangokushi_default
# 서버 고유 식별자 (기본값은 SESSION_ID와 동일)
SERVER_ID=opensam_default
# 사용자에게 보여질 서버 이름
SERVER_NAME=OpenSAM 삼국지
# 시나리오 시작 연도 기본값
DEFAULT_SESSION_START_YEAR=180

# [Game Mode] 실행 모드
# 기본 게임 모드 (turn: 턴제, realtime: 실시간)
GAME_MODE=turn
# 유저 한 명당 생성 가능한 최대 장수 수
MAX_GENERALS_PER_USER=3

# [Calendar] 게임 시간 체계
# 게임 시간 1개월당 소요되는 턴 수
GAME_TURNS_PER_MONTH=12
# 게임 시간 1년당 개월 수
GAME_MONTHS_PER_YEAR=12

# [Game Balance] 상세 밸런스 조정
# 초기 지급 금/군량/병력
GAME_DEFAULT_GOLD=1000
GAME_DEFAULT_RICE=1000
GAME_DEFAULT_CREW=1000
# 보유 가능한 최대 금/군량/병력
GAME_MAX_GOLD=1000000
GAME_MAX_RICE=1000000
GAME_MAX_CREW=50000
# 능력치(통무지정매) 최대값
GAME_MAX_LEADERSHIP=150
GAME_MAX_STRENGTH=150
GAME_MAX_INTEL=150
GAME_MAX_POLITICS=150
GAME_MAX_CHARM=150
# 최대 경험치 및 숙련도
GAME_MAX_EXPERIENCE=999999
GAME_MAX_DEDICATION=999999
# 실제 시간 턴 주기 (분 단위)
GAME_TURN_TERM=60
# 도시별 최대 개발 수치 (농업, 상업, 치안, 수비, 성벽)
GAME_MAX_CITY_FARM=100000
GAME_MAX_CITY_COMM=100000
GAME_MAX_CITY_SEC=100000
GAME_MAX_CITY_DEF=100000
GAME_MAX_CITY_WALL=100000
# 징병이 가능한 최소 도시 인구
GAME_MIN_RECRUIT_POP=20000
# 도시 확장 시 증가하는 인구 수
GAME_EXPAND_CITY_POP=100000
# 징병/훈련/기술연구/도시건설 기본 비용
GAME_RECRUIT_COST_GOLD=100
GAME_RECRUIT_COST_RICE=50
GAME_TRAIN_COST_GOLD=50
GAME_TRAIN_COST_RICE=50
GAME_RESEARCH_COST_GOLD=1000
GAME_RESEARCH_COST_RICE=500
GAME_BUILD_COST_GOLD=500
GAME_BUILD_COST_RICE=300
# 경험치/숙련도 획득 배율
GAME_EXP_MULTIPLIER=1.0
GAME_DEDICATION_MULTIPLIER=1.0
# 크리티컬 성공/실패 확률 및 배율
GAME_CRITICAL_SUCCESS_RATE=0.1
GAME_CRITICAL_FAIL_RATE=0.1
GAME_CRITICAL_SUCCESS_MUL=1.5
GAME_CRITICAL_FAIL_MUL=0.5
# 자원 거래 수수료 비율
GAME_EXCHANGE_FEE=0.05

# [City & Unit] 도시 및 장수 기본값
# 도시 민심 최대값 및 기본값
GAME_MAX_CITY_TRUST=100
GAME_DEFAULT_CITY_TRUST=50
# 도시 수치 최소값
GAME_MIN_CITY_VALUE=0
# 장수 훈련도/사기/숙련도 기본값 및 최대값
GAME_DEFAULT_TRAIN=50
GAME_DEFAULT_ATMOS=50
GAME_MAX_TRAIN=100
GAME_MAX_ATMOS=100
GAME_MAX_DEX=100

# [Battle] 전투 엔진 설정
# 전투 맵 크기 (가로, 세로)
BATTLE_MAP_WIDTH=800
BATTLE_MAP_HEIGHT=600
# 타일(그리드) 크기
BATTLE_TILE_SIZE=40
# 한 전투당 최대 진행 턴 수
BATTLE_MAX_TURNS=100
# 유닛 이동 및 공격 시 소모 행동력
BATTLE_MOVE_COST=1
BATTLE_ATTACK_COST=1
# 전투 세션 자동 종료 시간 (ms)
BATTLE_TIMEOUT=1800000
# 총사령관 지휘 기본 반경 (px)
BATTLE_HQ_RADIUS=250
# 전투 동시성 제어 락 TTL (초)
BATTLE_LOCK_TTL=30
# 전투 중 연결 끊김 유예 시간 (ms)
BATTLE_DISCONNECT_GRACE=60000
# 지형별 능력치 보정 (평지, 숲, 산, 수중)
BATTLE_BONUS_PLAINS=1.0
BATTLE_BONUS_FOREST=1.1
BATTLE_BONUS_MOUNTAIN=1.2
BATTLE_BONUS_WATER=0.8
# 날씨별 명중률 보정 (보통, 비, 눈)
BATTLE_WEATHER_NORMAL=1.0
BATTLE_WEATHER_RAIN=0.9
BATTLE_WEATHER_SNOW=0.8
# 사기 수치에 따른 공격력 보정 (고, 보통, 저)
BATTLE_MORALE_HIGH=1.2
BATTLE_MORALE_NORMAL=1.0
BATTLE_MORALE_LOW=0.8

# [NPC AI] AI 지능 및 난이도
# NPC AI 활성화 모드 (disabled, partial, full)
NPC_AI_MODE=full
# 전략적 난이도 (easy, normal, hard, expert)
AI_DIFFICULTY=normal
# NPC 생성 시 부여되는 최대 능력치
NPC_STAT_MAX=80
# 국가 수뇌 NPC의 최소 능력치 요건
NPC_CHIEF_STAT_MIN=60

# [Daemon] 자동 처리 주기 (ms)
# 턴 처리 스케줄러 실행 간격
TURN_INTERVAL=10000
# 캐시-DB 데이터 동기화 간격
DB_SYNC_INTERVAL=5000
# 자동 저장 실행 간격
AUTO_SAVE_INTERVAL=300000
# 턴 동시 처리 최대 세션 수
TURN_SCHEDULER_MAX_CONCURRENCY=3
# 데몬 시작 시 즉시 실행 여부 (true, false)
TURN_PROCESSOR_RUN_IMMEDIATELY=true

# [Timeouts] 만료 기간 설정 (ms)
# 유저 세션 유지 시간
TIMEOUT_SESSION=3600000
# 턴 처리 프로세스 타임아웃
TIMEOUT_TURN_PROCESS=60000

# [Feature Flags] 신규/실험적 기능
# 모바일 PWA 기능 활성화
ENABLE_PWA=true
# 리소스 CDN 사용 여부
ENABLE_CDN=false
# CDN 기본 주소
CDN_URL=
# 시나리오 파일 실시간 감시 활성화 (개발용)
ENABLE_FILE_WATCHER=false
# 레거시 전쟁 처리 엔진 사용 여부
ENABLE_LEGACY_PROCESS_WAR=true
# 모든 전투 자동 진행 강제 여부
FORCE_AUTO_BATTLE=true
# 은하영웅전설 모드 웹소켓 활성화
ENABLE_LOGH_WEBSOCKET=true
# 전술 전투 기능 활성화
ENABLE_GIN7_TACTICAL=true

# [OAuth] 카카오 로그인 연동
# 카카오 개발자 센터에서 발급받은 REST API 키
KAKAO_CLIENT_ID=
# 카카오 클라이언트 보안 키
KAKAO_CLIENT_SECRET=
# 카카오 로그인 리다이렉트 URI (백엔드 콜백 주소)
KAKAO_REDIRECT_URI=http://localhost:8080/api/oauth/kakao/callback
# 카카오 관리자 키 (연결 해제 등 관리용)
KAKAO_ADMIN_KEY=

# [Email] SMTP 발송 서버 (OTP 인증용)
# 메일 서버 호스트 주소
SMTP_HOST=smtp.gmail.com
# 메일 서버 포트
SMTP_PORT=587
# SSL/TLS 사용 여부
SMTP_SECURE=false
# 메일 발송 계정 (Gmail의 경우 반드시 전체 이메일 주소 입력 예: user@gmail.com)
SMTP_USER=
# 메일 발송 계정 비밀번호 (또는 앱 비밀번호)
SMTP_PASS=
